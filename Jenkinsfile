node {
    def app1
    def app2
    def app3
    def app5
    def app6
    def app7
    def app8
    def app9
    def app10
    def app11
    def app12
    def app13
    def app14
    def app15
    def app16
    def app17
    def app18
    def app19
    def app20
    def app21
    def app22
    def app23
    def app24
    def app25
    def app26
    def app27
    def app28
    def app29
    def app30
    def app31
    def app32
    def app33
    def app34
    def app35
    def app36
    def app37
    def app38
    def app39
    def app40
    def app41
    def app42
    def app43
    def app44
    def app45
    def app46
    def app47
    def app48
    def app49
    def app50
    def app51
    def app52
    def app53
    def app54
    def app55
    def app56
    def app57
    def app58
    def app59
    def app60

    stage('Clone Repository') {
        checkout scm
    }

    stage('Build image') {
        DOCKER_HOME = tool "docker"
        // sh "cp -r ade/cfg_files ."
        // sh "mv ade/Dockerfile ."
        // sh "mv ade/VERSION ."
        // app1 = docker.build("clefos/ade")
        // sh "rm -R cfg_files/"
        // sh "mv Dockerfile ade/"
        // sh "mv VERSION ade/"

        // sh "mv ansible/Dockerfile ."
        // app2 = docker.build("clefos/ansible")
        // sh "mv Dockerfile ansible/"

        // sh "mv bacula/docker-compose.yml ."
        // sh "mv bacula/bacula-db/Dockerfile ."
        // app3 = docker.build("clefos/bacula-db")
        // sh "mv Dockerfile bacula/bacula-db/"

        // sh "mv bacula/bacula-db-data/Dockerfile ."
        // app4 = docker.build("clefos/bacula-db-data")
        // sh "mv Dockerfile bacula/bacula-db-data/"

        // sh "mv bacula/bacula-dir/Dockerfile ."
        // sh "cp -r bacula/bacula-dir/configs ."
        // sh "cp -r bacula/bacula-dir/scripts ."
        // app5 = docker.build("clefos/bacula-dir")
        // sh "mv Dockerfile bacula/bacula-dir/"
        // sh "rm -R configs"
        // sh "rm -R scripts"

        // sh "mv bacula/bacula-fd/Dockerfile ."
        // sh "cp -r bacula/bacula-fd/configs ."
        // sh "cp -r bacula/bacula-fd/scripts ."
        // app6 = docker.build("clefos/bacula-fd")
        // sh "mv Dockerfile bacula/bacula-fd/"
        // sh "rm -R configs"
        // sh "rm -R scripts"

        // sh "mv bacula/bacula-sd/Dockerfile ."
        // sh "cp -r bacula/bacula-sd/configs ."
        // sh "cp -r bacula/bacula-sd/scripts ."
        // app7 = docker.build("clefos/bacula-sd")
        // sh "mv Dockerfile bacula/bacula-sd/"
        // sh "rm -R configs"
        // sh "rm -R scripts"
        // sh "mv docker-compose.yml bacula/"

        // sh "cp -r bind/container-image-root ."
        // sh "mv bind/Dockerfile ."
        // app8 = docker.build("clefos/bind")
        // sh "rm -R container-image-root"
        // sh "mv Dockerfile bind/"

        // sh "./busybox/build.sh"
        // sh "mv busybox/glibc/Dockerfile ."
        // sh "mv busybox/glibc/busybox.tar.xz ."
        // app9 = docker.build("clefos/glibc-test")
        // sh "mv Dockerfile busybox/glibc/"
        // sh "mv busybox.tar.xz busybox/glibc/"

        // sh "mv cobol/Dockerfile ."
        // app10 = docker.build("clefos/cobol")
        // sh "mv Dockerfile cobol/"

        // sh "cp -r compose-ui/files ."
        // sh "mv compose-ui/Dockerfile ."
        // app11 = docker.build("clefos/compose-ui")
        // sh "rm -R files"
        // sh "mv Dockerfile compose-ui/"

        // sh "mv couchdb/install.sh ."
        // sh "mv couchdb/Dockerfile ."
        // app12 = docker.build("clefos/couchdb")
        // sh "mv install.sh couchdb/"
        // sh "mv Dockerfile couchdb/"

        // sh "mv django/Dockerfile ."
        // app13 = docker.build("clefos/django")
        // sh "mv Dockerfile django/"

        // sh "cp -r docker-swarm-visualizer/files ."
        // sh "mv docker-swarm-visualizer/package.json ."
        // sh "mv docker-swarm-visualizer/Dockerfile ."
        // app14 = docker.build("clefos/visualizer")
        // sh "rm -R files"
        // sh "mv package.json docker-swarm-visualizer/"
        // sh "mv Dockerfile docker-swarm-visualizer/"

        // // sh "mv earthquake/Dockerfile ."
        // // app15 = docker.build("clefos/earthquake")
        // // sh "mv Dockerfile earthquake/"

        // sh "mv erlang/Dockerfile ."
        // app16 = docker.build("clefos/erlang")
        // sh "mv Dockerfile erlang/"

        // sh "mv etcd/Dockerfile ."
        // sh "mv etcd/etcd-s390x.patch ."
        // app17 = docker.build("clefos/etcd")
        // sh "mv Dockerfile etcd/"
        // sh "mv etcd-s390x.patch etcd/"

        // sh "mv fluentd/Dockerfile ."
        // app18 = docker.build("clefos/fluentd")
        // sh "mv Dockerfile fluentd/"

        // sh "mv golang/Dockerfile ."
        // sh "mv golang/go-wrapper ."
        // app19 = docker.build("clefos/golang")
        // sh "mv Dockerfile golang/"
        // sh "mv go-wrapper golang/"

        // // sh "cd grafana && make grafana-latest.tar.gz && cd .."
        // // sh "mv grafana/grafana-latest.tar.gz ."
        // // sh "mv grafana/Dockerfile ."
        // // app20 = docker.build("clefos/grafana")
        // // sh "mv grafana-latest.tar.gz grafana/"
        // // sh "mv Dockerfile grafana/"

        // sh "cp -r hadoop-openshift/bin ."
        // sh "cp -r hadoop-openshift/etc ."
        // sh "mv hadoop-openshift/Dockerfile ."
        // sh "mv hadoop-openshift/hadoop-cluster-template.json ."
        // sh "wget https://archive.apache.org/dist/hadoop/core/hadoop-2.8.1/hadoop-2.8.1.tar.gz"
        // app21 = docker.build("clefos/hadoop");
        // sh "rm -R bin"
        // sh "rm -R etc"
        // sh "rm hadoop-2.8.1.tar.gz"
        // sh "mv Dockerfile hadoop-openshift/"
        // sh "mv hadoop-cluster-template.json hadoop-openshift/"

        // sh "mv hello-nodejs/Dockerfile ."
        // sh "mv hello-nodejs/index.js ."
        // sh "mv hello-nodejs/package.json ."
        // app22 = docker.build("clefos/hello-nodejs")
        // sh "mv Dockerfile hello-nodejs/"
        // sh "mv index.js hello-nodejs/"
        // sh "mv package.json hello-nodejs/"

        // sh "mv httpd/Dockerfile ."
        // sh "mv httpd/run-httpd.sh ."
        // app23 = docker.build("clefos/httpd");
        // sh "mv Dockerfile httpd/"
        // sh "mv run-httpd.sh httpd/"

        // sh "mv ibmjava/8/jre/Dockerfile ."
        // app24 = docker.build("clefos/ibmjava:8-jre")
        // sh "mv Dockerfile ibmjava/8/jre/"

        // sh "mv ibmjava/8/sdk/Dockerfile ."
        // app25 = docker.build("clefos/ibmjava:8-sdk ")
        // sh "mv Dockerfile ibmjava/8/sdk/"

        // sh "mv ibmjava/8/sfj/Dockerfile ."
        // app26 = docker.build("clefos/ibmjava:8-sfj")
        // sh "mv Dockerfile ibmjava/8/sfj/"

        // sh "mv ibmjava/11/sdk/Dockerfile ."
        // app27 = docker.build("clefos/ibmjava:11-sdk ")
        // sh "mv Dockerfile ibmjava/11/sdk/"
        
        // sh "mv ibmjava/8/maven/Dockerfile ."
        // app28 = docker.build("clefos/maven:8")
        // sh "mv Dockerfile ibmjava/8/maven/"

        // sh "mv ibmjava/11/maven/Dockerfile ."
        // app29 = docker.build("clefos/maven:11")
        // sh "mv Dockerfile ibmjava/11/maven/"

        // sh "cd jboss ; git clone https://github.com/jboss-dockerfiles/wildfly.git ; cd .."
        // sh "cd jboss/wildfly ; git checkout 11.0.0.Final -b s390x ; cd .."
        // sh "mv jboss/wildfly/Dockerfile ."
        // app30 = docker.build("clefos/jboss-wildfly")
        // sh "mv Dockerfile jboss/wildfly/"

        // sh "mv jupyter/Dockerfile ."
        // app31 = docker.build("clefos/jupyter")
        // sh "mv Dockerfile jupyter/"

        // sh "mv kubernetes/Dockerfile ."
        // sh "mv kubernetes/kubernetes.sh ."
        // app32 = docker.build("clefos/kubernetes")
        // sh "mv kubernetes.sh kubernetes/"
        // sh "mv Dockerfile kubernetes/"

        // sh "mv lighttpd/Dockerfile ."
        // sh "cp -r lighttpd/cfg_files ."
        // app33 = docker.build("clefos/lighttpd")
        // sh "rm -R cfg_files"
        // sh "mv Dockerfile lighttpd/"

        // sh "mv mariadb/Dockerfile ."
        // sh "mv mariadb/allow-skip-name.cnf ."
        // sh "mv mariadb/docker-entrypoint.sh ."
        // sh "mv mariadb/fix-permissions.sh ."
        // app34 = docker.build("clefos/mariadb")
        // sh "mv Dockerfile mariadb/"
        // sh "mv allow-skip-name.cnf mariadb/"
        // sh "mv docker-entrypoint.sh mariadb/"
        // sh "mv fix-permissions.sh mariadb/"

        // sh "mv MEAN/Dockerfile ."
        // sh "mv MEAN/mongo.repo ."
        // app35 = docker.build("clefos/mean")
        // sh "mv Dockerfile MEAN/"
        // sh "mv mongo.repo MEAN/"

        // sh "cd meanjs ; make all"
        // app36 = docker.image("clefos/meanjs") 

        // sh "mv mediawiki/Dockerfile ."
        // sh "mv mediawiki/fpm-pool-www.conf ."
        // sh "mv mediawiki/fpm.conf ."
        // sh "mv mediawiki/mediawiki-start ."
        // sh "mv mediawiki/nginx.conf ."
        // sh "mv mediawiki/supervisord.conf ."
        // app37 = docker.build("clefos/mediawiki")
        // sh "mv Dockerfile mediawiki/"
        // sh "mv fpm-pool-www.conf mediawiki/"
        // sh "mv fpm.conf mediawiki/"
        // sh "mv mediawiki-start mediawiki/"
        // sh "mv nginx.conf mediawiki/"
        // sh "mv supervisord.conf mediawiki/"

        // sh "mv memcached/Dockerfile ."
        // app38 = docker.build("clefos/memcached")
        // sh "mv Dockerfile memcached/"

        // sh "cd microclimate ; make all"
        // app39 = docker.image("clefos/bats")
        // app40 = docker.image("clefos/curl")
        // app41 = docker.image("clefos/helm")
        // app42 = docker.image("clefos/jenkins")
        // app43 = docker.image("clefos/jnlp-slave")
        // app44 = docker.image("clefos/kubectl")
        // app45 = docker.image("clefos/minikube")

        // sh "cd mongodb ; make all"
        // app46 = docker.image("clefos/mongodb")
        // sh "cd mono ; make all"
        // app47 = docker.image("clefos/mono")

        // sh "cd nginx ; make all"
        // app48 = docker.image("clefos/nginx")
        // sh "docker rmi clefos/nginx"

        // sh "cd nodejs ; make all"
        // app49 = docker.image("clefos/node:8")
        // app50 = docker.image("clefos/node:10")
        // app51 = docker.image("clefos/node:12")
        // sh "docker rmi clefos/node:8"
        // sh "docker rmi clefos/node:10"
        // sh "docker rmi clefos/node:12"

        // sh "cd openJDK ; make all"
        // app52 = docker.image("clefos/openjdk:8")
        // app53 = docker.image("clefos/openjdk:11")
        // app54 = docker.image("clefos/openjdk:12")
        // sh "docker rmi clefos/openjdk:8"
        // sh "docker rmi clefos/openjdk:11"
        // sh "docker rmi clefos/openjdk:12"

        // sh "cd hadoop-openshift ; wget https://archive.apache.org/dist/hadoop/core/hadoop-3.1.0/hadoop-3.1.0.tar.gz"
        // sh "cd openshift-spark ; make all"
        // app55 = docker.image("docker.io/clefos/spark")
        // app56 = docker.image("docker.io/clefos/zeppelin")
        // sh "docker rmi docker.io/clefos/spark"
        // sh "docker rmi docker.io/clefos/zeppelin"

        
        // sh "cd origin"

        // sh "cd owncloud ; make all"
        // app57 = docker.image("clefos/owncloud")
        // sh "docker rmi clefos/owncloud"

        // sh "cd postgresql ; make all"
        // app58 = docker.image("clefos/postgresql")
        // sh "docker rmi clefos/postgresql"

        // sh "cd puppet ; make all"
        // app59 = docker.image("clefos/puppet")
        // sh "docker rmi clefos/puppet"

        // sh "cd qpid ; make clefos/qpid"
        // app60 = docker.image("clefos/qpid")
        // sh "docker rmi clefos/qpid"

        // sh "cd R-base ; make all"
        // app61 = docker.image("clefos/r-base")
        // sh "docker rmi clefos/r-base"

        // sh "cd rabbitmq ; make all"
        // app62 = docker.image("clefos/rabbitmq")
        // sh "docker rmi clefos/rabbitmq"

        // sh "cd react ; make all"
        // app63 = docker.image("react-api")
        // app64 = docker.image("react-client")
        // sh "docker rmi react-client"
        // sh "docker rmi react-api"

        // sh "cd redis ; make all"
        // app65 = docker.image("clefos/redis")
        // sh "docker rmi clefos/redis"

        // sh "cd registry ; make all"
        // app66 = docker.image("clefos/registry")
        // sh "docker rmi clefos/registry"

        // sh "cd saltmaster ; make all"
        // app67 = docker.image("clefos/saltmaster")
        // sh "docker rmi clefos/saltmaster"

        // sh "cd solr ; make all"
        // app68 = docker.image("clefos/solr")
        // sh "docker rmi clefos/solr"

        // sh "cd spark ; make all"
        // app69 = docker.image("clefos/spark-sa")
        // sh "docker rmi clefos/spark-sa"

        sh "cd spark-ui-proxy ; make all"
        app70 = docker.image("clefos/spark-ui-proxy")
        sh "docker rmi clefos/spark-ui-proxy"

    }

    // stage('Push'){
    //     docker.withRegistry('https://registry.hub.docker.com', 'dockerhub-credentials') {
    //         app36.push("meanjs")
    //     }
        
    // }

    stage('Cleanup'){
        sh "docker system prune -f"
    }
}